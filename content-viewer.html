<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ§  AIå…§å®¹ç€è¦½å™¨ | AIç”Ÿæ´»åˆ†äº«ç¤¾åœ˜</title>
  <link rel="stylesheet" href="assets/style.css">
  
  <!-- æ·»åŠ  PDF.js åº« -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.9.179/pdf.min.js"></script>
  <script>
    pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.9.179/pdf.worker.min.js';
  </script>
  
  <style>
    /* ä¿æŒæ‚¨çš„åŸå§‹æ¨£å¼ */
    .viewer-container { max-width: 1400px; margin: 0 auto; padding: 20px; }
    .ai-header { background: linear-gradient(135deg, #6366f1 0%, #8b5cf6 100%); color: white; padding: 25px; border-radius: 15px; margin-bottom: 30px; text-align: center; box-shadow: 0 10px 30px rgba(99, 102, 241, 0.3); }
    .viewer-content { display: grid; grid-template-columns: 350px 1fr; gap: 30px; margin-bottom: 40px; }
    .sidebar { background: white; border-radius: 15px; padding: 25px; box-shadow: 0 5px 20px rgba(0,0,0,0.08); border: 1px solid #e0e7ff; height: fit-content; }
    .category-filter { margin-bottom: 25px; }
    .category-buttons { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 15px; }
    .category-btn { padding: 8px 16px; background: #f3f4f6; border: 1px solid #e5e7eb; border-radius: 20px; font-size: 0.85rem; cursor: pointer; transition: all 0.3s ease; color: #4b5563; }
    .category-btn.active { background: #6366f1; color: white; border-color: #6366f1; }
    .content-select { width: 100%; height: 350px; font-size: 0.95rem; border: 1px solid #e5e7eb; border-radius: 10px; padding: 12px; margin-bottom: 20px; background: #f9fafb; }
    .nav-buttons { display: flex; flex-direction: column; gap: 12px; margin-bottom: 25px; }
    .nav-btn { padding: 14px; font-size: 1rem; background: #6366f1; color: white; border: none; border-radius: 10px; cursor: pointer; transition: all 0.3s ease; text-align: center; font-weight: 600; }
    .nav-btn:hover { background: #4f46e5; transform: translateY(-2px); box-shadow: 0 5px 15px rgba(99, 102, 241, 0.3); }
    .back-btn { background: #6b7280; }
    .back-btn:hover { background: #4b5563; }
    .viewer-main { background: white; border-radius: 15px; padding: 30px; box-shadow: 0 5px 20px rgba(0,0,0,0.08); border: 1px solid #e0e7ff; }
    .content-display-area { min-height: 600px; margin-bottom: 30px; }
    .pdf-canvas-container { text-align: center; margin-bottom: 25px; background: #f9fafb; border-radius: 12px; padding: 25px; }
    #pdfCanvas { max-width: 100%; height: auto; border: 1px solid #e5e7eb; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); background: white; }
    .external-links-panel { display: flex; flex-wrap: wrap; gap: 15px; margin: 30px 0; padding: 25px; background: #f0f9ff; border-radius: 12px; border: 1px solid #dbeafe; }
    .link-btn { display: flex; align-items: center; gap: 10px; padding: 14px 24px; background: white; border: 2px solid #e0e7ff; border-radius: 10px; text-decoration: none; color: #6366f1; font-weight: 600; transition: all 0.3s ease; flex: 1; min-width: 200px; justify-content: center; }
    .link-btn:hover { background: #6366f1; color: white; transform: translateY(-3px); box-shadow: 0 8px 20px rgba(99, 102, 241, 0.2); }
    .link-youtube { border-color: #ff0000; color: #ff0000; }
    .link-youtube:hover { background: #ff0000; color: white; border-color: #ff0000; }
    .link-webpage { border-color: #10b981; color: #10b981; }
    .link-webpage:hover { background: #10b981; color: white; border-color: #10b981; }
    .link-folder { border-color: #8b5cf6; color: #8b5cf6; }
    .link-folder:hover { background: #8b5cf6; color: white; border-color: #8b5cf6; }
    .status-info { text-align: center; margin: 25px 0; padding: 25px; background: #f9fafb; border-radius: 12px; font-weight: 600; color: #374151; border: 2px dashed #d1d5db; }
    .page-controls { display: flex; justify-content: center; align-items: center; gap: 25px; margin: 25px 0; flex-wrap: wrap; }
    .page-btn { padding: 14px 28px; background: #6366f1; color: white; border: none; border-radius: 10px; cursor: pointer; transition: all 0.3s ease; font-weight: 600; }
    .page-btn:hover { background: #4f46e5; transform: translateY(-2px); box-shadow: 0 5px 15px rgba(99, 102, 241, 0.3); }
    .page-info { font-weight: 700; color: #374151; font-size: 1.2rem; min-width: 180px; text-align: center; }
    .zoom-controls { display: flex; justify-content: center; align-items: center; gap: 20px; margin: 25px 0; padding: 20px; background: #f9fafb; border-radius: 12px; }
    .zoom-btn { padding: 12px 20px; background: white; border: 2px solid #e0e7ff; border-radius: 10px; cursor: pointer; font-size: 1.2rem; transition: all 0.3s ease; font-weight: bold; }
    .zoom-btn:hover { background: #6366f1; color: white; border-color: #6366f1; }
    .stats-container { display: flex; justify-content: space-between; align-items: center; margin: 30px 0; padding: 25px; background: linear-gradient(135deg, #f0f9ff, #f8f9fa); border-radius: 12px; border: 1px solid #dbeafe; flex-wrap: wrap; gap: 20px; }
    .stat-block { display: flex; align-items: center; gap: 15px; }
    .stat-number { font-weight: bold; color: #6366f1; font-size: 1.5rem; min-width: 60px; text-align: center; }
    .social-sharing { display: flex; gap: 15px; align-items: center; }
    .share-btn { padding: 12px 24px; background: #e0e7ff; color: #6366f1; border: none; border-radius: 10px; cursor: pointer; transition: all 0.3s ease; font-weight: 600; }
    .share-btn:hover { background: #6366f1; color: white; transform: translateY(-2px); }
    .fb-share-btn { background: #1877f2; color: white; }
    .fb-share-btn:hover { background: #0d5bb9; }
    .loading { display: inline-block; width: 20px; height: 20px; border: 3px solid #e0e7ff; border-top: 3px solid #6366f1; border-radius: 50%; animation: spin 1s linear infinite; margin-right: 10px; vertical-align: middle; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    .webpage-frame { width: 100%; height: 600px; border: none; border-radius: 12px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); margin: 20px 0; }
    .folder-view { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; margin: 25px 0; }
    .folder-item { background: white; border: 2px solid #e0e7ff; border-radius: 12px; padding: 25px; cursor: pointer; transition: all 0.3s ease; text-align: center; }
    .folder-item:hover { background: #e0e7ff; border-color: #6366f1; transform: translateY(-5px); }
    .folder-icon { font-size: 3rem; margin-bottom: 15px; color: #6366f1; }
    
    /* æ–°å¢ï¼šPDF åŠ è¼‰è³‡è¨Šæ¨£å¼ */
    .pdf-loading-info { margin: 20px 0; }
    .github-tip { background: #f0f9ff; border-left: 4px solid #3b82f6; padding: 15px; border-radius: 8px; margin: 15px 0; }
    .github-tip h4 { color: #1e40af; margin-bottom: 8px; }
    .github-tip p { color: #4b5563; margin-bottom: 10px; font-size: 0.9rem; }
    
    /* éŸ¿æ‡‰å¼è¨­è¨ˆ */
    @media (max-width: 1024px) { .viewer-content { grid-template-columns: 1fr; } .sidebar { order: 2; } .viewer-main { order: 1; } .content-select { height: 250px; } }
    @media (max-width: 768px) {
      .page-controls { flex-direction: column; }
      .stats-container { flex-direction: column; text-align: center; }
      .social-sharing { flex-direction: column; width: 100%; }
      .share-btn { width: 100%; }
      .external-links-panel { flex-direction: column; }
      .link-btn { width: 100%; }
      .webpage-frame { height: 400px; }
    }
    @media (max-width: 480px) {
      .ai-header { padding: 20px 15px; }
      .viewer-container { padding: 15px; }
      .category-buttons { justify-content: center; }
      .zoom-controls { flex-wrap: wrap; }
    }
  </style>
</head>
<body class="container">
  <header class="page-header">
    <h1>ğŸ§  AIå…§å®¹ç€è¦½å™¨</h1>
    <p class="subtitle">å¤šåŠŸèƒ½AIå­¸ç¿’è³‡æºç€è¦½å™¨ - PDFã€ç¶²é ã€å½±ç‰‡ä¸€éµé–‹å•Ÿ</p>
  </header>
  
  <div class="ai-header">
    <h2>ğŸš€ AIå­¸ç¿’è³‡æºä¸­å¿ƒ</h2>
    <p>æ•´åˆPDFæ•™æã€æ•™å­¸å½±ç‰‡ã€å¤–éƒ¨ç¶²ç«™é€£çµï¼Œä¸€ç«™å¼å­¸ç¿’é«”é©—</p>
  </div>
  
  <nav class="breadcrumb">
    <a href="index.html">é¦–é </a> &gt; <span>AIå…§å®¹ç€è¦½å™¨</span>
  </nav>
  
  <main class="viewer-container">
    <div class="viewer-content">
      <aside class="sidebar">
        <h3 style="color: #6366f1; margin-bottom: 20px;">ğŸ“š è³‡æºåˆ†é¡</h3>
        
        <div class="category-filter">
          <h4>ğŸ” é¸æ“‡åˆ†é¡</h4>
          <div class="category-buttons">
            <button class="category-btn active" onclick="filterCategory('all')">å…¨éƒ¨</button>
            <button class="category-btn" onclick="filterCategory('beginner')">å…¥é–€æŒ‡å—</button>
            <button class="category-btn" onclick="filterCategory('tools')">å·¥å…·æ•™å­¸</button>
            <button class="category-btn" onclick="filterCategory('productivity')">å·¥ä½œæ•ˆç‡</button>
            <button class="category-btn" onclick="filterCategory('design')">å‰µæ„è¨­è¨ˆ</button>
            <button class="category-btn" onclick="filterCategory('advanced')">é€²éšæŠ€å·§</button>
            <button class="category-btn" onclick="filterCategory('line-ai')">Line AIæ‡‰ç”¨</button>
          </div>
        </div>
        
        <select id="contentSelect" size="10" class="content-select"></select>
        
        <div class="nav-buttons">
          <button onclick="prevContent()" class="nav-btn">â¬…ï¸ ä¸Šä¸€å€‹è³‡æº</button>
          <button onclick="nextContent()" class="nav-btn">â¡ï¸ ä¸‹ä¸€å€‹è³‡æº</button>
          <button onclick="window.location.href='index.html'" class="nav-btn back-btn">ğŸ  è¿”å›é¦–é </button>
          <button onclick="showPDFStats()" class="nav-btn" style="background: #8b5cf6; margin-top: 10px;">
            ğŸ“Š PDFçµ±è¨ˆ
          </button>
        </div>
        
        <div class="sidebar-info">
          <h4 style="color: #6366f1; margin-bottom: 15px;">ğŸ’¡ ä½¿ç”¨èªªæ˜</h4>
          <ul style="font-size: 0.9rem; color: #6b7280; padding-left: 20px;">
            <li>é¸æ“‡å·¦å´è³‡æºåˆ—è¡¨ç€è¦½å…§å®¹</li>
            <li>å¤–éƒ¨é€£çµæœƒåœ¨æ–°è¦–çª—é–‹å•Ÿ</li>
            <li>PDFå„ªå…ˆå¾GitHubåŠ è¼‰æœ€æ–°ç‰ˆæœ¬</li>
            <li>æ”¯æ´PDFç¸®æ”¾èˆ‡åˆ†é ç€è¦½</li>
          </ul>
        </div>
      </aside>
      
      <section class="viewer-main">
        <div class="content-display-area" id="contentDisplay">
          <div class="status-info" id="statusText">
            <span class="loading"></span>è«‹é¸æ“‡å·¦å´çš„AIå­¸ç¿’è³‡æº
          </div>
        </div>
        
        <!-- å¤–éƒ¨é€£çµé¢æ¿ -->
        <div id="externalLinksPanel" class="external-links-panel" style="display: none;">
          <h4 style="color: #6366f1; width: 100%; margin: 0 0 15px 0;">ğŸ”— ç›¸é—œé€£çµ</h4>
        </div>
        
        <!-- PDFæ§åˆ¶ -->
        <div id="pdfControls" style="display: none;">
          <div class="page-controls">
            <button onclick="prevPage()" class="page-btn">ğŸ“„ ä¸Šä¸€é </button>
            <span class="page-info" id="pageInfo">ç¬¬ 0 é  / å…± 0 é </span>
            <button onclick="nextPage()" class="page-btn">ğŸ“„ ä¸‹ä¸€é </button>
          </div>
          
          <div class="zoom-controls">
            <button onclick="zoomOut()" class="zoom-btn">ğŸ” -</button>
            <span style="font-weight: 600; color: #374151;">ç¸®æ”¾: <span id="zoomLevel">100%</span></span>
            <button onclick="zoomIn()" class="zoom-btn">ğŸ” +</button>
            <button onclick="resetZoom()" class="zoom-btn">ğŸ”„ é‡ç½®</button>
          </div>
        </div>
        
        <div class="stats-container">
          <div class="stat-block">
            <span style="font-weight: 600; color: #374151;">ğŸ‘ï¸ ç€è¦½æ¬¡æ•¸ï¼š</span>
            <span class="stat-number" id="viewCount">0</span>
          </div>
          
          <div class="social-sharing">
            <span style="font-weight: 600; color: #374151;">åˆ†äº«ï¼š</span>
            <button onclick="shareToFacebook()" class="share-btn fb-share-btn">ğŸ“˜ Facebook</button>
            <button onclick="copyResourceLink()" class="share-btn">ğŸ”— è¤‡è£½é€£çµ</button>
          </div>
        </div>
      </section>
    </div>
  </main>
  
  <footer style="text-align: center; margin-top: 4rem; padding: 2rem; background: linear-gradient(135deg, #f0f9ff, #f8f9fa); border-radius: 15px; border: 1px solid #dbeafe;">
    <h3 style="color: #6366f1; margin-bottom: 20px;">ğŸš€ é–‹å§‹ä½ çš„AIå­¸ç¿’ä¹‹æ—…</h3>
    <p>æŒæ¡AIå·¥å…·ï¼Œæå‡å·¥ä½œæ•ˆç‡èˆ‡ç”Ÿæ´»å“è³ª</p>
    
    <div style="display: flex; justify-content: center; gap: 20px; margin-top: 30px; flex-wrap: wrap;">
      <a href="index.html" class="btn" style="background: #6b7280; color: white;">ğŸ  è¿”å›é¦–é </a>
      <a href="video-player.html" class="btn btn-primary">ğŸ¥ è§€çœ‹æ•™å­¸å½±ç‰‡</a>
      <a href="https://www.facebook.com/groups/2076786986493869/" target="_blank" class="btn" style="background: #1877f2; color: white;">ğŸ‘¥ åŠ å…¥Facebookç¤¾åœ˜</a>
    </div>
    
    <div style="margin-top: 30px; padding-top: 20px; border-top: 1px solid #e5e7eb;">
      <p style="font-size: 0.9rem; color: #6b7280;">
        ğŸ’¡ æç¤ºï¼šPDFè³‡æºå„ªå…ˆå¾GitHub ReleaseåŠ è¼‰æœ€æ–°ç‰ˆæœ¬
      </p>
    </div>
  </footer>

  <!-- JavaScript éƒ¨åˆ† -->
  <script>
    // ========== å…¨å±€è®Šæ•¸ ==========
    const manifestURL = './data_ai/manifest.json';
    let contentList = [];
    let filteredList = [];
    let currentIndex = -1;
    let currentPage = 1;
    let totalPages = 1;
    let currentPDF = null;
    let currentScale = 1.5;
    let currentResource = null;
    
    // ========== ä¸»è¦å‡½æ•¸ ==========
    
    // åˆå§‹åŒ–è¼‰å…¥
    async function loadContentList() {
      showStatus('è¼‰å…¥AIå­¸ç¿’è³‡æºæ¸…å–®ä¸­...');
      
      try {
        const res = await fetch(manifestURL);
        if (res.ok) {
          contentList = await res.json();
          showStatus(`âœ… æˆåŠŸè¼‰å…¥ ${contentList.length} å€‹è³‡æº`);
        } else {
          contentList = [];
          showStatus('âŒ ç„¡æ³•è¼‰å…¥ manifest.json æ–‡ä»¶');
        }
      } catch (err) {
        console.error('è¼‰å…¥ manifest.json æ™‚ç™¼ç”ŸéŒ¯èª¤:', err);
        contentList = [];
        showStatus('âŒ è¼‰å…¥è³‡æºæ¸…å–®æ™‚ç™¼ç”ŸéŒ¯èª¤');
      }
      
      loadLocalStats();
      filteredList = [...contentList];
      updateContentSelect();
      
      if (contentList.length > 0) {
        showContent(0);
      } else {
        clearContentDisplay();
        showStatus('âŒ æ²’æœ‰å¯ç”¨çš„AIå­¸ç¿’è³‡æº');
      }
    }
    
    // é¡¯ç¤ºå…§å®¹
    async function showContent(index) {
      if (index < 0 || index >= filteredList.length) return;
      
      currentIndex = index;
      currentPage = 1;
      currentResource = filteredList[index];
      
      const originalIndex = contentList.findIndex(item => item.id === currentResource.id);
      
      showStatus(`è¼‰å…¥${currentResource.title}ä¸­...`);
      
      recordPageView('content_viewer');
      
      if (originalIndex >= 0) {
        contentList[originalIndex].views = (contentList[originalIndex].views || 0) + 1;
        saveLocalStats();
        updateStats(originalIndex);
      }
      
      displayContentByType(currentResource);
      document.getElementById('contentSelect').value = index;
    }
    
    // æ ¹æ“šé¡å‹é¡¯ç¤ºå…§å®¹
    function displayContentByType(resource) {
      const displayArea = document.getElementById('contentDisplay');
      displayArea.innerHTML = '';
      
      const pdfControls = document.getElementById('pdfControls');
      const externalLinksPanel = document.getElementById('externalLinksPanel');
      
      pdfControls.style.display = 'none';
      externalLinksPanel.style.display = 'none';
      
      // é¡¯ç¤ºè³‡æºæè¿°
      const description = document.createElement('div');
      description.className = 'resource-description';
      description.innerHTML = `
        <h3 style="color: #6366f1; margin-bottom: 15px;">${resource.title}</h3>
        <p style="color: #6b7280; line-height: 1.6; margin-bottom: 20px;">${resource.description || 'ç„¡æè¿°'}</p>
        <div style="display: flex; gap: 10px; margin-top: 15px;">
          <span style="background: #e0e7ff; color: #6366f1; padding: 6px 12px; border-radius: 20px; font-size: 0.85rem;">
            ${getContentTypeName(resource.type)}
          </span>
          <span style="background: #f3f4f6; color: #6b7280; padding: 6px 12px; border-radius: 20px; font-size: 0.85rem;">
            ${getCategoryName(resource.category)}
          </span>
          ${resource.githubRelease ? '<span style="background: #dbeafe; color: #1e40af; padding: 6px 12px; border-radius: 20px; font-size: 0.85rem;">ğŸŒ GitHubç‰ˆæœ¬</span>' : ''}
        </div>
      `;
      displayArea.appendChild(description);
      
      // æ ¹æ“šé¡å‹é¡¯ç¤º
      switch(resource.type) {
        case 'pdf':
          displayPDF(resource);
          pdfControls.style.display = 'flex';
          break;
        case 'youtube':
          displayYouTube(resource);
          break;
        case 'webpage':
          displayWebPage(resource);
          break;
        case 'folder':
          displayFolder(resource);
          break;
        default:
          showStatus('âŒ ä¸æ”¯æ´çš„è³‡æºé¡å‹');
      }
      
      if (resource.externalLinks && resource.externalLinks.length > 0) {
        showExternalLinks(resource.externalLinks);
      }
      
      showStatus(`âœ… å·²è¼‰å…¥: ${resource.title}`);
    }
    
    // ========== é—œéµä¿®æ”¹ï¼šPDF åŠ è¼‰å‡½æ•¸ ==========
    async function displayPDF(resource) {
      const displayArea = document.getElementById('contentDisplay');
      
      // é¡¯ç¤ºåŠ è¼‰ä¿¡æ¯
      const loadingDiv = document.createElement('div');
      loadingDiv.className = 'pdf-loading-info';
      loadingDiv.innerHTML = `
        <div style="padding: 15px; background: #f0f9ff; border-radius: 8px; margin: 15px 0;">
          <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 10px;">
            <span class="loading"></span>
            <strong style="color: #1e40af;">æ­£åœ¨åŠ è¼‰PDF...</strong>
          </div>
          <div style="font-size: 0.85rem; color: #4b5563;">
            <div><strong>æª”æ¡ˆï¼š</strong>${resource.title}</div>
            ${resource.githubRelease ? `
              <div><strong>ä¾†æºï¼š</strong>GitHub Releaseï¼ˆæœ€æ–°ç‰ˆæœ¬ï¼‰</div>
            ` : `
              <div><strong>ä¾†æºï¼š</strong>æœ¬åœ°æª”æ¡ˆ</div>
            `}
          </div>
        </div>
      `;
      displayArea.appendChild(loadingDiv);
      
      // å‰µå»ºç•«å¸ƒå®¹å™¨
      const canvasContainer = document.createElement('div');
      canvasContainer.className = 'pdf-canvas-container';
      canvasContainer.innerHTML = '<canvas id="pdfCanvas"></canvas>';
      displayArea.appendChild(canvasContainer);
      
      try {
        // å„ªå…ˆå¾ GitHub Release åŠ è¼‰
        let pdfUrl = resource.githubRelease || resource.url;
        let sourceType = resource.githubRelease ? 'GitHub Release' : 'æœ¬åœ°æª”æ¡ˆ';
        
        showStatus(`å¾ ${sourceType} åŠ è¼‰ PDF...`);
        
        // ä½¿ç”¨PDF.jsåŠ è¼‰
        const loadingTask = pdfjsLib.getDocument({
          url: pdfUrl,
          withCredentials: false
        });
        
        const pdf = await loadingTask.promise;
        
        // ç§»é™¤åŠ è¼‰ä¿¡æ¯
        loadingDiv.remove();
        
        currentPDF = pdf;
        totalPages = pdf.numPages;
        renderPage(currentPage);
        
        showStatus(`âœ… PDFè¼‰å…¥å®Œæˆ (${sourceType}): ${resource.title} (å…± ${totalPages} é )`);
        
        // é¡¯ç¤ºGitHubä¸‹è¼‰æç¤º
        if (resource.githubRelease) {
          const githubTip = document.createElement('div');
          githubTip.className = 'github-tip';
          githubTip.innerHTML = `
            <h4>ğŸ’¡ æ­£åœ¨å¾ GitHub Release åŠ è¼‰æœ€æ–°ç‰ˆæœ¬</h4>
            <p>å¦‚éœ€é›¢ç·šæŸ¥çœ‹æˆ–GitHubåŠ è¼‰ç·©æ…¢ï¼Œå¯åˆ‡æ›åˆ°æœ¬åœ°ç‰ˆæœ¬</p>
            <button onclick="switchToLocalPDF('${resource.id}')" 
                    style="padding: 8px 16px; background: #3b82f6; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 0.9rem;">
              åˆ‡æ›åˆ°æœ¬åœ°ç‰ˆæœ¬
            </button>
          `;
          canvasContainer.parentNode.insertBefore(githubTip, canvasContainer.nextSibling);
        }
        
      } catch (error) {
        console.error('PDF åŠ è¼‰å¤±æ•—ï¼š', error);
        
        // å¦‚æœGitHubåŠ è¼‰å¤±æ•—ï¼Œå˜—è©¦æœ¬åœ°ç‰ˆæœ¬
        if (resource.githubRelease && resource.url !== resource.githubRelease) {
          showStatus('GitHubåŠ è¼‰å¤±æ•—ï¼Œå˜—è©¦æœ¬åœ°ç‰ˆæœ¬...');
          
          try {
            const localLoadingTask = pdfjsLib.getDocument(resource.url);
            const pdf = await localLoadingTask.promise;
            
            loadingDiv.remove();
            
            currentPDF = pdf;
            totalPages = pdf.numPages;
            renderPage(currentPage);
            
            showStatus(`âœ… ä½¿ç”¨æœ¬åœ°ç‰ˆæœ¬è¼‰å…¥å®Œæˆ: ${resource.title} (å…± ${totalPages} é )`);
            
            // é¡¯ç¤ºæç¤º
            const localTip = document.createElement('div');
            localTip.className = 'github-tip';
            localTip.style.borderLeftColor = '#10b981';
            localTip.innerHTML = `
              <h4>â„¹ï¸ ä½¿ç”¨æœ¬åœ°ç‰ˆæœ¬</h4>
              <p>GitHubç‰ˆæœ¬æš«æ™‚ç„¡æ³•åŠ è¼‰ï¼Œå·²è‡ªå‹•åˆ‡æ›åˆ°æœ¬åœ°ç‰ˆæœ¬</p>
              <a href="${resource.githubRelease}" target="_blank" 
                 style="padding: 8px 16px; background: #6b7280; color: white; border-radius: 6px; text-decoration: none; font-size: 0.9rem; display: inline-block; margin-top: 5px;">
                ç›´æ¥ä¸‹è¼‰GitHubç‰ˆæœ¬
              </a>
            `;
            canvasContainer.parentNode.insertBefore(localTip, canvasContainer.nextSibling);
            
            return;
          } catch (localError) {
            console.error('æœ¬åœ°ç‰ˆæœ¬ä¹ŸåŠ è¼‰å¤±æ•—ï¼š', localError);
          }
        }
        
        // å…©å€‹ä¾†æºéƒ½å¤±æ•—
        loadingDiv.innerHTML = `
          <div style="padding: 15px; background: #fee; border-radius: 8px; margin: 15px 0;">
            <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 10px;">
              <span style="color: #dc2626; font-size: 1.2rem;">âŒ</span>
              <strong style="color: #dc2626;">PDFåŠ è¼‰å¤±æ•—</strong>
            </div>
            <div style="font-size: 0.85rem; color: #4b5563; margin-bottom: 15px;">
              ${error.message}
            </div>
            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
              ${resource.githubRelease ? `
                <a href="${resource.githubRelease}" target="_blank" 
                   style="padding: 8px 16px; background: #3b82f6; color: white; border-radius: 6px; text-decoration: none; font-size: 0.9rem;">
                  ğŸ”— ä¸‹è¼‰GitHubç‰ˆæœ¬
                </a>
              ` : ''}
              <button onclick="retryLoadPDF()" 
                      style="padding: 8px 16px; background: #6b7280; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 0.9rem;">
                ğŸ”„ é‡æ–°å˜—è©¦
              </button>
            </div>
          </div>
        `;
        
        showStatus(`âŒ ${resource.title} åŠ è¼‰å¤±æ•—`);
      }
    }
    
    // ========== è¼”åŠ©å‡½æ•¸ ==========
    
    // åˆ‡æ›åˆ°æœ¬åœ°PDF
    function switchToLocalPDF(resourceId) {
      const originalResource = contentList.find(item => item.id === resourceId);
      if (originalResource) {
        currentResource = { ...originalResource };
        // æš«æ™‚ç§»é™¤githubReleaseï¼Œå¼·åˆ¶ä½¿ç”¨æœ¬åœ°
        delete currentResource.githubRelease;
        displayContentByType(currentResource);
        showStatus('ğŸ”„ å·²åˆ‡æ›åˆ°æœ¬åœ°ç‰ˆæœ¬');
      }
    }
    
    // é‡æ–°åŠ è¼‰PDF
    function retryLoadPDF() {
      if (currentResource) {
        displayContentByType(currentResource);
      }
    }
    
    // æ¸²æŸ“PDFé é¢
    function renderPage(pageNum) {
      if (!currentPDF) return;
      
      currentPDF.getPage(pageNum).then(page => {
        const viewport = page.getViewport({ scale: currentScale });
        const canvas = document.getElementById('pdfCanvas');
        const context = canvas.getContext('2d');
        
        canvas.height = viewport.height;
        canvas.width = viewport.width;
        
        const renderContext = {
          canvasContext: context,
          viewport: viewport
        };
        
        page.render(renderContext).promise.then(() => {
          document.getElementById('pageInfo').textContent = `ç¬¬ ${pageNum} é  / å…± ${totalPages} é `;
          document.getElementById('zoomLevel').textContent = Math.round(currentScale * 100) + '%';
        });
      }).catch(err => {
        console.error('é é¢æ¸²æŸ“å¤±æ•—ï¼š', err);
        showStatus('âŒ é é¢æ¸²æŸ“å¤±æ•—');
      });
    }
    
    // é¡¯ç¤ºPDFçµ±è¨ˆ
    function showPDFStats() {
      const pdfResources = contentList.filter(item => item.type === 'pdf');
      const githubPDFs = pdfResources.filter(item => item.githubRelease);
      
      const statsDiv = document.createElement('div');
      statsDiv.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: white;
        padding: 25px;
        border-radius: 15px;
        box-shadow: 0 15px 35px rgba(0,0,0,0.2);
        z-index: 1000;
        max-width: 500px;
        width: 90%;
      `;
      
      statsDiv.innerHTML = `
        <h3 style="color: #6366f1; margin-bottom: 20px; text-align: center;">ğŸ“Š PDFè³‡æºçµ±è¨ˆ</h3>
        
        <div style="margin-bottom: 20px;">
          <div style="display: flex; justify-content: space-between; margin-bottom: 10px; padding: 10px; background: #f9fafb; border-radius: 8px;">
            <span>ç¸½PDFæ•¸é‡ï¼š</span>
            <strong style="color: #6366f1;">${pdfResources.length}</strong>
          </div>
          <div style="display: flex; justify-content: space-between; margin-bottom: 10px; padding: 10px; background: #f0f9ff; border-radius: 8px;">
            <span>æ”¯æ´GitHub Releaseï¼š</span>
            <strong style="color: #10b981;">${githubPDFs.length}</strong>
          </div>
        </div>
        
        ${githubPDFs.length > 0 ? `
          <div style="margin-bottom: 20px;">
            <h4 style="color: #374151; margin-bottom: 10px;">GitHub Release PDFsï¼š</h4>
            <div style="max-height: 200px; overflow-y: auto;">
              ${githubPDFs.map(pdf => `
                <div style="padding: 8px 10px; background: #f8fafc; border-radius: 6px; margin-bottom: 8px; border-left: 3px solid #3b82f6;">
                  <div style="display: flex; justify-content: space-between; align-items: center;">
                    <span style="font-size: 0.9rem;">${pdf.title}</span>
                    <a href="${pdf.githubRelease}" target="_blank" 
                       style="color: #3b82f6; text-decoration: none; font-size: 1.2rem;">ğŸ”—</a>
                  </div>
                </div>
              `).join('')}
            </div>
          </div>
        ` : ''}
        
        <button onclick="this.parentElement.parentElement.removeChild(this.parentElement)" 
                style="width: 100%; padding: 12px; background: #6366f1; color: white; border: none; border-radius: 10px; cursor: pointer; font-weight: 600;">
          é—œé–‰
        </button>
      `;
      
      // æ·»åŠ é®ç½©
      const overlay = document.createElement('div');
      overlay.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.5);
        z-index: 999;
      `;
      overlay.onclick = () => {
        document.body.removeChild(overlay);
        document.body.removeChild(statsDiv);
      };
      
      document.body.appendChild(overlay);
      document.body.appendChild(statsDiv);
    }
    
    // ========== åŸºæœ¬åŠŸèƒ½å‡½æ•¸ ==========
    
    function getContentTypeName(type) {
      const types = {
        'pdf': 'ğŸ“„ PDFæ–‡ä»¶',
        'youtube': 'ğŸ¬ æ•™å­¸å½±ç‰‡',
        'webpage': 'ğŸŒ ç¶²ç«™é€£çµ',
        'folder': 'ğŸ“ è³‡æºå¤¾'
      };
      return types[type] || type;
    }
    
    function getCategoryName(category) {
      const categories = {
        'all': 'å…¨éƒ¨',
        'beginner': 'å…¥é–€æŒ‡å—',
        'tools': 'å·¥å…·æ•™å­¸',
        'productivity': 'å·¥ä½œæ•ˆç‡',
        'design': 'å‰µæ„è¨­è¨ˆ',
        'advanced': 'é€²éšæŠ€å·§',
        'line-ai': 'Line AIæ‡‰ç”¨'
      };
      return categories[category] || category;
    }
    
    function filterCategory(category) {
      document.querySelectorAll('.category-btn').forEach(btn => {
        btn.classList.remove('active');
      });
      event.target.classList.add('active');
      
      if (category === 'all') {
        filteredList = [...contentList];
      } else {
        filteredList = contentList.filter(item => item.category === category);
      }
      
      updateContentSelect();
      
      if (filteredList.length > 0) {
        showContent(0);
      } else {
        showStatus(`âŒ æ²’æœ‰${getCategoryName(category)}ç›¸é—œè³‡æº`);
        clearContentDisplay();
      }
    }
    
    function updateContentSelect() {
      const select = document.getElementById('contentSelect');
      select.innerHTML = '';
      
      filteredList.forEach((item, index) => {
        const option = document.createElement('option');
        option.value = index;
        
        // å¦‚æœæœ‰ GitHub Releaseï¼Œæ·»åŠ æ¨™è¨˜
        let title = `${index + 1}. ${item.title}`;
        if (item.type === 'pdf' && item.githubRelease) {
          title += ' ğŸŒ';
        }
        
        option.textContent = title;
        select.appendChild(option);
      });
    }
    
    function loadLocalStats() {
      const stats = JSON.parse(localStorage.getItem('ai_stats') || '{}');
      contentList.forEach((item, index) => {
        if (stats[item.id]) {
          item.views = stats[item.id].views || 0;
          item.likes = stats[item.id].likes || 0;
        } else {
          item.views = 0;
          item.likes = 0;
        }
      });
    }
    
    function saveLocalStats() {
      const stats = {};
      contentList.forEach(item => {
        stats[item.id] = {
          views: item.views || 0,
          likes: item.likes || 0,
          lastViewed: new Date().toISOString()
        };
      });
      localStorage.setItem('ai_stats', JSON.stringify(stats));
    }
    
    function updateStats(index) {
      const item = contentList[index];
      if (item) {
        document.getElementById('viewCount').textContent = item.views || 0;
      }
    }
    
    function showStatus(message) {
      const statusElement = document.getElementById('statusText');
      if (statusElement) {
        if (message.includes('è¼‰å…¥ä¸­') || message.includes('...')) {
          statusElement.innerHTML = `<span class="loading"></span>${message}`;
        } else {
          statusElement.textContent = message;
        }
      }
    }
    
    function clearContentDisplay() {
      const displayArea = document.getElementById('contentDisplay');
      displayArea.innerHTML = '';
      document.getElementById('pdfControls').style.display = 'none';
      document.getElementById('externalLinksPanel').style.display = 'none';
    }
    
    // ========== é é¢æ§åˆ¶å‡½æ•¸ ==========
    
    function prevContent() {
      if (currentIndex > 0) {
        showContent(currentIndex - 1);
      }
    }
    
    function nextContent() {
      if (currentIndex < filteredList.length - 1) {
        showContent(currentIndex + 1);
      }
    }
    
    function prevPage() {
      if (currentPDF && currentPage > 1) {
        currentPage--;
        renderPage(currentPage);
      }
    }
    
    function nextPage() {
      if (currentPDF && currentPage < totalPages) {
        currentPage++;
        renderPage(currentPage);
      }
    }
    
    function zoomIn() {
      currentScale += 0.25;
      if (currentPDF) renderPage(currentPage);
    }
    
    function zoomOut() {
      currentScale = Math.max(0.5, currentScale - 0.25);
      if (currentPDF) renderPage(currentPage);
    }
    
    function resetZoom() {
      currentScale = 1.5;
      if (currentPDF) renderPage(currentPage);
    }
    
    function shareToFacebook() {
      if (!currentResource) return;
      
      const text = encodeURIComponent(`æˆ‘åœ¨AIç”Ÿæ´»åˆ†äº«ç¤¾åœ˜ç™¼ç¾ï¼š${currentResource.title}`);
      const url = encodeURIComponent(window.location.href);
      window.open(`https://www.facebook.com/sharer/sharer.php?u=${url}&quote=${text}`, '_blank', 'width=600,height=400');
    }
    
    function copyResourceLink() {
      if (!currentResource) return;
      
      const link = window.location.origin + window.location.pathname + '?resource=' + currentResource.id;
      navigator.clipboard.writeText(link).then(() => {
        alert('å·²è¤‡è£½è³‡æºé€£çµåˆ°å‰ªè²¼ç°¿ï¼');
      }).catch(err => {
        console.error('è¤‡è£½å¤±æ•—:', err);
      });
    }
    
    function recordPageView(page) {
      const key = `views_${page}`;
      let count = parseInt(localStorage.getItem(key) || '0');
      count++;
      localStorage.setItem(key, count.toString());
    }
    
    // ========== å…¶ä»–é¡¯ç¤ºå‡½æ•¸ ==========
    
    function displayYouTube(resource) {
      const displayArea = document.getElementById('contentDisplay');
      displayArea.innerHTML += `
        <div style="position: relative; width: 100%; padding-bottom: 56.25%; margin: 20px 0;">
          <iframe src="${resource.url}" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; border-radius: 12px;" allowfullscreen></iframe>
        </div>
      `;
    }
    
    function displayWebPage(resource) {
      const displayArea = document.getElementById('contentDisplay');
      displayArea.innerHTML += `
        <iframe src="${resource.url}" class="webpage-frame" sandbox="allow-same-origin allow-scripts allow-forms allow-popups" referrerpolicy="no-referrer"></iframe>
      `;
    }
    
    function displayFolder(resource) {
      const displayArea = document.getElementById('contentDisplay');
      
      if (resource.items && resource.items.length > 0) {
        let folderHTML = '<div class="folder-view">';
        resource.items.forEach(item => {
          folderHTML += `
            <div class="folder-item" onclick="alert('å¦‚éœ€æŸ¥çœ‹æ­¤é …ç›®ï¼Œè«‹åœ¨ä¸»æ¸…å–®ä¸­é¸æ“‡')">
              <div class="folder-icon">${getContentTypeIcon(item.type)}</div>
              <h4 style="margin: 0 0 10px 0; color: #374151;">${item.title}</h4>
              <p style="margin: 0; color: #6b7280; font-size: 0.9rem;">${getContentTypeName(item.type)}</p>
            </div>
          `;
        });
        folderHTML += '</div>';
        displayArea.innerHTML += folderHTML;
      }
    }
    
    function getContentTypeIcon(type) {
      const icons = {
        'pdf': 'ğŸ“„',
        'youtube': 'ğŸ¬',
        'webpage': 'ğŸŒ',
        'folder': 'ğŸ“'
      };
      return icons[type] || 'ğŸ“„';
    }
    
    function showExternalLinks(links) {
      const panel = document.getElementById('externalLinksPanel');
      panel.style.display = 'flex';
      panel.innerHTML = '<h4 style="color: #6366f1; width: 100%; margin: 0 0 15px 0;">ğŸ”— ç›¸é—œé€£çµ</h4>';
      
      links.forEach(link => {
        const linkBtn = document.createElement('a');
        linkBtn.href = link.url;
        linkBtn.target = '_blank';
        linkBtn.rel = 'noopener noreferrer';
        linkBtn.className = `link-btn link-${link.type}`;
        linkBtn.innerHTML = `
          <span class="link-icon">${getContentTypeIcon(link.type)}</span>
          <span class="link-text">${link.name}</span>
        `;
        panel.appendChild(linkBtn);
      });
    }
    
    // ========== äº‹ä»¶ç›£è½å™¨ ==========
    
    document.addEventListener('DOMContentLoaded', function() {
      loadContentList();
      
      // æª¢æŸ¥URLåƒæ•¸
      const urlParams = new URLSearchParams(window.location.search);
      const resourceId = urlParams.get('resource');
      const category = urlParams.get('category');
      
      if (category) {
        // è‡ªå‹•é¸æ“‡å°æ‡‰çš„åˆ†é¡
        const categoryBtn = document.querySelector(`.category-btn[onclick*="filterCategory('${category}')"]`);
        if (categoryBtn) {
          setTimeout(() => categoryBtn.click(), 500);
        }
      }
      
      // é¸æ“‡æ¡†äº‹ä»¶
      document.getElementById('contentSelect').addEventListener('change', function () {
        const index = parseInt(this.value);
        if (!isNaN(index)) showContent(index);
      });
      
      // éµç›¤å¿«æ·éµ
      document.addEventListener('keydown', function(event) {
        if (event.key === 'ArrowLeft') {
          if (currentPDF) {
            prevPage();
          } else {
            prevContent();
          }
        } else if (event.key === 'ArrowRight') {
          if (currentPDF) {
            nextPage();
          } else {
            nextContent();
          }
        } else if (event.key === '+') {
          zoomIn();
        } else if (event.key === '-') {
          zoomOut();
        } else if (event.ctrlKey && event.key === 'f') {
          event.preventDefault();
          shareToFacebook();
        }
      });
    });
  </script>
</body>
</html>